{"generator":"Code Snippets v2.10.1.1","date_created":"2018-08-11 12:36","snippets":[{"name":"Nofollow Check Box f\u00fcr den Editor","tags":["seo"],"scope":"admin","code":"add_action( 'after_wp_tiny_mce', function(){\r\n\t?>\r\n\t<script>\r\n\t\tvar originalWpLink;\r\n\t\t\/\/ Ensure both TinyMCE, underscores and wpLink are initialized\r\n\t\tif ( typeof tinymce !== 'undefined' && typeof _ !== 'undefined' && typeof wpLink !== 'undefined' ) {\r\n\t\t\t\/\/ Ensure the #link-options div is present, because it's where we're appending our checkbox.\r\n\t\t\tif ( tinymce.$('#link-options').length ) {\r\n\t\t\t\t\/\/ Append our checkbox HTML to the #link-options div, which is already present in the DOM.\r\n\t\t\t\ttinymce.$('#link-options').append(<?php echo json_encode( '<div class=\"link-nofollow\"><label><span><\/span><input type=\"checkbox\" id=\"wp-link-nofollow\" \/> Add rel=\"nofollow\" to link<\/label><\/div>' ); ?>);\r\n\t\t\t\t\/\/ Clone the original wpLink object so we retain access to some functions.\r\n\t\t\t\toriginalWpLink = _.clone( wpLink );\r\n\t\t\t\twpLink.addRelNofollow = tinymce.$('#wp-link-nofollow');\r\n\t\t\t\t\/\/ Override the original wpLink object to include our custom functions.\r\n\t\t\t\twpLink = _.extend( wpLink, {\r\n\t\t\t\t\t\/**\r\n\t\t\t\t\t * Fetch attributes for the generated link based on\r\n\t\t\t\t\t * the link editor form properties.\r\n\t\t\t\t\t *\r\n\t\t\t\t\t * In this case, we're calling the original getAttrs()\r\n\t\t\t\t\t * function, and then including our own behavior.\r\n\t\t\t\t\t *\/\r\n\t\t\t\t\tgetAttrs: function() {\r\n\t\t\t\t\t\tvar attrs = originalWpLink.getAttrs();\r\n\t\t\t\t\t\tattrs.rel = wpLink.addRelNofollow.prop( 'checked' ) ? 'nofollow' : false;\r\n\t\t\t\t\t\treturn attrs;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\/**\r\n\t\t\t\t\t * Build the link's HTML based on attrs when inserting\r\n\t\t\t\t\t * into the text editor.\r\n\t\t\t\t\t *\r\n\t\t\t\t\t * In this case, we're completely overriding the existing\r\n\t\t\t\t\t * function.\r\n\t\t\t\t\t *\/\r\n\t\t\t\t\tbuildHtml: function( attrs ) {\r\n\t\t\t\t\t\tvar html = '<a href=\"' + attrs.href + '\"';\r\n\t\t\t\t\t\tif ( attrs.target ) {\r\n\t\t\t\t\t\t\thtml += ' target=\"' + attrs.target + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( attrs.rel ) {\r\n\t\t\t\t\t\t\thtml += ' rel=\"' + attrs.rel + '\"';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn html + '>';\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\/**\r\n\t\t\t\t\t * Set the value of our checkbox based on the presence\r\n\t\t\t\t\t * of the rel='nofollow' link attribute.\r\n\t\t\t\t\t *\r\n\t\t\t\t\t * In this case, we're calling the original mceRefresh()\r\n\t\t\t\t\t * function, then including our own behavior\r\n\t\t\t\t\t *\/\r\n\t\t\t\t\tmceRefresh: function( searchStr, text ) {\r\n\t\t\t\t\t\toriginalWpLink.mceRefresh( searchStr, text );\r\n\t\t\t\t\t\tvar editor = window.tinymce.get( window.wpActiveEditor )\r\n\t\t\t\t\t\tif ( typeof editor !== 'undefined' && ! editor.isHidden() ) {\r\n\t\t\t\t\t\t\tvar linkNode = editor.dom.getParent( editor.selection.getNode(), 'a[href]' );\r\n\t\t\t\t\t\t\tif ( linkNode ) {\r\n\t\t\t\t\t\t\t\twpLink.addRelNofollow.prop( 'checked', 'nofollow' === editor.dom.getAttrib( linkNode, 'rel' ) );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t<\/script>\r\n\t<style>\r\n\t#wp-link #link-options .link-nofollow {\r\n\t\tpadding: 3px 0 0;\r\n\t\twhite-space: nowrap;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t}\r\n\t#wp-link #link-options .link-nofollow label span {\r\n\t\twidth: 83px;\r\n\t}\r\n\t.has-text-field #wp-link .query-results {\r\n\t\ttop: 223px;\r\n\t}\r\n\t<\/style>\r\n\t<?php\r\n});"}]}